<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>asx - AgentScript, 2nd Edition</title>
  <meta name="description" content="AgentScript, 2nd Edition">
  <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
  <link rel="stylesheet" href="//unpkg.com/docsify/lib/themes/vue.css">
</head>
<body>
  <div id="app"></div>
</body>
<script>
  const repo = 'https://github.com/backspaces/asx'
  const root = document.location.href.replace(/#.*/,'')
  // const readme = root.replace(/\/*/, 'README.md')
  const tutorial = `${root}tutorial/`
  console.log('href', document.location.href, 'root', root)

  window.$docsify = {
    // alias : { // apparently only work in md files?
    //   '/repo': `${repo}`,
    //   '/root': `${root}`,
    //   // '/readme': 'http://backspaces.github.io/asx/README.md',
    //   '/hello': `${root}tutorial/?hello`,
    // },
    // markdown: {
    //   renderer: {
    //     link: function (href, title, text) {
    //       console.log('link', href, title, text)
    //       const result = href.match(/tutorial/)
    //         ? `<a href="${href}">tutorial ${text}</a>`
    //         : `<a href="${href}">${text}</a>`
    //       return result
    //     }
    //   }
    // },

    markdown: {
      gfm: true,
      // breaks: true,
      smartypants: true,
    },
    repo: `${repo}`, // repo alias fails
    // homepage: 'http://backspaces.github.io/asx/README.md',
    homepage: 'README.md',
    name: 'AgentScript',
    auto2top: true,
    loadSidebar: true,
    maxLevel: 4,
    subMaxLevel: 2,
    // routerMode: 'history', // default: 'hash'
    plugins: [
      function(hook, vm) {
        hook.beforeEach((markdown) => {
          const result = markdown.replace(/]\(tutorial\//g, `](${root}/tutorial/`)
          // const result = markdown.replace('](tutorial/', `](${root}/tutorial/`)
          // console.log('markdown', result)
          return result
        })
      }
    ],
  }

  console.log('window.$docsify', window.$docsify)
</script>
<script src="//unpkg.com/docsify/lib/docsify.js"></script>
<script>
  console.log('---- Post docsify.js load')
  console.log('window.$docsify', $docsify)
</script>
</html>
